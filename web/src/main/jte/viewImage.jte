@import ru.yakovlev.school.web.dto.ImageInfo
@import ru.yakovlev.school.web.entity.ImageStatus

@param ImageInfo image

!{String description = image == null ? "–Ω–µ –Ω–∞–π–¥–µ–Ω–æ" : image.description();}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/images/view-image.css">
    <title>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${description}</title>

    @if(image!=null && image.status().equals(ImageStatus.IN_PROCESS))
        <meta http-equiv="refresh" content="3">
    @endif
</head>
<body>
@if (image == null)
    <p>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
@elseif(image.status().equals(ImageStatus.IN_PROCESS))
    <p>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤–æ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...</p>
@elseif(image.status().equals(ImageStatus.FAILED))
    <p>–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ üò≠, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</p>
@else
    <div class="image-container">
        <img src="${image.url()}" alt="–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ" width="800"/>


        <h3 id="description-label">${image.description()}</h3>

        <form id="form-edit" action="/images/${image.id()}/update" method="post" class="hidden form-edit">
            <label for="description">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:</label>
            <textarea rows="5" cols="40" name="description" id="description"
                      required>${image.description()}</textarea>
            <input type="submit" value="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"/>
        </form>


        <p class="prompt-paragraph">–ü—Ä–æ–º–ø—Ç: ${image.prompt()}</p>
        <div class="button-container">
            <button id="edit-button" onclick="handleEdit()">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ</button>
        </div>
    </div>
@endif

<script>
    function handleEdit() {
        document.getElementById("description-label").classList.add("hidden")
        document.getElementById("edit-button").classList.add("hidden")
        document.getElementById("form-edit").classList.remove("hidden")
    }
</script>
</body>
</html>
